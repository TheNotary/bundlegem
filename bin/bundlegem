#!/usr/bin/env ruby

# Exit cleanly from an early interrupt
Signal.trap("INT") { exit 1 }
require 'bundler'
require 'bundlegem'
# require 'bundlergem/friendly_errors'


if ARGV.length < 1
  puts "error: you need to specify a name for the project being created\n\n"
  puts Bundlegem::HELP_MSG
  exit 1
end

if ARGV[0] == "--help"
  puts Bundlegem::HELP_MSG
  exit 0
end

if ARGV[0] == "--list" or ARGV[0] == "-l"
  puts Bundlegem.list
  exit 0
end

if ARGV[0] == "--newtemplate"
  puts "Sorry, I haven't been implemented, I don't have a lot of free time atm :("
  exit 0
  Bundlegem.newtemplate(ARGV)
end

if ARGV[0] == "--install-best-templates"
  puts Bundlegem.install_best_templates
  exit 0
end



options = {"bin"=>false, "ext"=>false, :coc=> false}
gem_name = ARGV[0] # gem name

if ARGV.length > 1
  if ARGV[1] != "-t" and ARGV[1] != "--template"
    puts "You can ONLY use -t as an argument because I'm quite busy and should be doing something else right now!"
    puts Bundlegem::HELP_MSG
    exit 1
  end

  options.merge!({"template" => ARGV[2]})
end

Bundlegem.gem(options, gem_name)
